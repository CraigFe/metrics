<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Src (metrics.Metrics.Src)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">metrics</a> &#x00BB; <a href="../index.html">Metrics</a> &#x00BB; Src</nav><h1>Module <code>Metrics.Src</code></h1></header><div class="doc"><p>Metric sources.</p></div><section><header><h2 id="sources"><a href="#sources" class="anchor"></a>Sources</h2></header><dl><dt class="spec value" id="val-v"><a href="#val-v" class="anchor"></a><code><span class="keyword">val </span>v : ?&#8288;doc:string <span>&#8209;&gt;</span> tags:(<span class="type-var">'a</span>, (<span class="type-var">'b</span>, [ `Any ]) <a href="../index.html#type-t">t</a>) <a href="../Tags/index.html#type-t">Tags.t</a> <span>&#8209;&gt;</span> data:<span class="type-var">'b</span> <span>&#8209;&gt;</span> string <span>&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, [ `Any ]) <a href="../index.html#type-src">src</a></code></dt><dd><p><code>v ?doc ~tags name</code> is a new source, accepting arbitrary data points. <code>name</code> is the name of the source; it doesn't need to be unique but it is good practice to prefix the name with the name of your package or library (e.g. <code>&quot;mypkg.network&quot;</code>). <code>doc</code> is a documentation string describing the source, defaults to <code>&quot;undocumented&quot;</code>. <code>tags</code> is the collection if (typed) tags which will be used to tag and index the measure and are used identify the various metrics. The source will be enabled on creation iff one of tag in <code>tags</code> has been enabled with <a href="../index.html#val-enable_tag"><code>enable_tag</code></a>.</p><p>For instance, to create a metric to collect CPU and memory usage on various machines, indexed by <code>PID</code>, <code>host</code> name and <code>IP</code> address:</p><pre><code>let src =
  let ipaddr = Tags.ty Ipaddr.pp_hum in
  let tags = Frame.[
      &quot;host&quot;, string;
      &quot;IP&quot;  , ipaddr;
      &quot;PID&quot; , int
    ] in
  let data () = Data.v [
      &quot;%CPU&quot;, Data.float (...);
      &quot;MEM&quot; , Data.int   (...);
    ] in
  Src.v &quot;top&quot; ~tags ~data ~doc:&quot;Information about processess&quot;</code></pre></dd></dl></section><section><header><h2 id="status"><a href="#status" class="anchor"></a>Status</h2></header><dl><dt class="spec type" id="type-result"><a href="#type-result" class="anchor"></a><code><span class="keyword">type </span>result</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-result.Ok" class="anchored"><td class="def constructor"><a href="#type-result.Ok" class="anchor"></a><code><span class="keyword">| </span></code><code>`Ok</code></td></tr><tr id="type-result.Error" class="anchored"><td class="def constructor"><a href="#type-result.Error" class="anchor"></a><code><span class="keyword">| </span></code><code>`Error</code></td></tr></table><code> ]</code><code></code></dt><dd><p>The type for result events.</p></dd></dl><dl><dt class="spec type" id="type-status_src"><a href="#type-status_src" class="anchor"></a><code><span class="keyword">type </span>'a status_src</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, <a href="index.html#type-result">result</a> <span>&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Status ]) <a href="../index.html#type-src">src</a></code><code></code></dt><dd><p>The type for status sources.</p></dd></dl><dl><dt class="spec type" id="type-status"><a href="#type-status" class="anchor"></a><code><span class="keyword">type </span>status</code><code><span class="keyword"> = </span>(<a href="index.html#type-result">result</a> <span>&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Status ]) <a href="../index.html#type-t">t</a></code><code></code></dt><dd><p>The type for status sources whose tags have been fully resolved.</p></dd></dl><dl><dt class="spec value" id="val-status"><a href="#val-status" class="anchor"></a><code><span class="keyword">val </span>status : ?&#8288;doc:string <span>&#8209;&gt;</span> tags:(<span class="type-var">'a</span>, <a href="index.html#type-status">status</a>) <a href="../Tags/index.html#type-t">Tags.t</a> <span>&#8209;&gt;</span> string <span>&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-status_src">status_src</a></code></dt><dd><p>Same as <a href="index.html#val-v"><code>v</code></a> but create a new status source.</p></dd></dl></section><section><header><h2 id="timers"><a href="#timers" class="anchor"></a>Timers</h2></header><dl><dt class="spec type" id="type-timer_src"><a href="#type-timer_src" class="anchor"></a><code><span class="keyword">type </span>'a timer_src</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, int64 <span>&#8209;&gt;</span> <a href="index.html#type-result">result</a> <span>&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Timer ]) <a href="../index.html#type-src">src</a></code><code></code></dt><dd><p>The type for timer sources. The callback takes the duration of the event in milliseconds (an <code>int64</code>) and the status: <code>Error</code> or <code>Success</code>.</p></dd></dl><dl><dt class="spec type" id="type-timer"><a href="#type-timer" class="anchor"></a><code><span class="keyword">type </span>timer</code><code><span class="keyword"> = </span>(int64 <span>&#8209;&gt;</span> <a href="index.html#type-result">result</a> <span>&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Timer ]) <a href="../index.html#type-t">t</a></code><code></code></dt><dd><p>The type for timer source, whose tags have been fully resolved.</p></dd></dl><dl><dt class="spec value" id="val-timer"><a href="#val-timer" class="anchor"></a><code><span class="keyword">val </span>timer : ?&#8288;doc:string <span>&#8209;&gt;</span> tags:(<span class="type-var">'a</span>, <a href="index.html#type-timer">timer</a>) <a href="../Tags/index.html#type-t">Tags.t</a> <span>&#8209;&gt;</span> string <span>&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-timer_src">timer_src</a></code></dt><dd><p>Same as <a href="index.html#val-v"><code>v</code></a> but create a new timer source.</p></dd></dl></section><section><header><h2 id="listing-sources"><a href="#listing-sources" class="anchor"></a>Listing Sources</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-t.Src" class="anchored"><td class="def constructor"><a href="#type-t.Src" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Src</span><span class="keyword"> : </span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="../index.html#type-src">src</a> <span>&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></td><td class="doc"><p>The type for metric sources.</p></td></tr></table><code></code></dt></dl><dl><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">val </span>list : unit <span>&#8209;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p><code>list ()</code> is the current exisiting source list.</p></dd></dl><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val </span>name : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> string</code></dt><dd><p><code>name src</code> is <code>src</code>'s name.</p></dd></dl><dl><dt class="spec value" id="val-kind"><a href="#val-kind" class="anchor"></a><code><span class="keyword">val </span>kind : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> <a href="../index.html#type-kind">kind</a></code></dt><dd><p><code>kind src</code> is <code>src</code>'s kind.</p></dd></dl><dl><dt class="spec value" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span class="keyword">val </span>doc : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> string</code></dt><dd><p><code>doc src</code> is <code>src</code>'s documentation string.</p></dd></dl><dl><dt class="spec value" id="val-domain"><a href="#val-domain" class="anchor"></a><code><span class="keyword">val </span>domain : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> string list</code></dt><dd><p><code>domain src</code> is the list of tags of <code>src</code> (if any).</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val </span>equal : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> bool</code></dt><dd><p><code>equal src src'</code> is <code>true</code> iff <code>src</code> and <code>src'</code> are the same source.</p></dd></dl><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val </span>compare : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> int</code></dt><dd><p><code>compare src src'</code> is a total order on sources.</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val </span>pp : <a href="index.html#type-t">t</a> Fmt.t</code></dt><dd><p><code>pp ppf src</code> prints an unspecified representation of <code>src</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-enable"><a href="#val-enable" class="anchor"></a><code><span class="keyword">val </span>enable : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>enable src</code> enables the metric source <code>src</code>.</p></dd></dl><dl><dt class="spec value" id="val-disable"><a href="#val-disable" class="anchor"></a><code><span class="keyword">val </span>disable : <a href="index.html#type-t">t</a> <span>&#8209;&gt;</span> unit</code></dt><dd><p><code>disable src</code> disables the metric source <code>src</code>.</p></dd></dl></section></div></body></html>