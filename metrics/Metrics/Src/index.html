<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Src (metrics.Metrics.Src)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">metrics</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Metrics.Src</span></h1></header><div class="doc"><p>Data sources.</p></div><h2>Sources</h2><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-t.Src" class="anchored"><td class="def constructor"><a href="#type-t.Src" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Src</span><span class="keyword"> : </span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="../index.html#type-src">src</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></td><td class="doc"><p>(** The type for metric sources. *)</p></td></tr></table><code></code></div><div class="doc"></div></div><div class="spec val" id="val-name"><a href="#val-name" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>name : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">name src</code> is <code class="code">src</code>'s name.</p></div></div><div class="spec val" id="val-kind"><a href="#val-kind" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>kind : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-kind">kind</a></code></div><div class="doc"><p><code class="code">kind src</code> is <code class="code">src</code>'s kind.</p></div></div><div class="spec val" id="val-doc"><a href="#val-doc" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>doc : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">doc src</code> is <code class="code">src</code>'s documentation string.</p></div></div><div class="spec val" id="val-domain"><a href="#val-domain" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>domain : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string list</code></div><div class="doc"><p><code class="code">domain src</code> is the list of tags of <code class="code">src</code> (if any).</p></div></div><div class="spec val" id="val-equal"><a href="#val-equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>equal : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">equal src src'</code> is <code class="code">true</code> iff <code class="code">src</code> and <code class="code">src'</code> are the same source.</p></div></div><div class="spec val" id="val-compare"><a href="#val-compare" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>compare : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">compare src src'</code> is a total order on sources.</p></div></div><div class="spec val" id="val-pp"><a href="#val-pp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp : Format.formatter <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">pp ppf src</code> prints an unspecified representation of <code class="code">src</code> on
<code class="code">ppf</code>.</p></div></div><div class="spec val" id="val-enable"><a href="#val-enable" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>enable : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">enable src</code> enables the metric source <code class="code">src</code>.</p></div></div><div class="spec val" id="val-disable"><a href="#val-disable" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>disable : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">disable src</code> disables the metric source <code class="code">src</code>.</p></div></div><div class="spec val" id="val-list"><a href="#val-list" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>list : unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> list</code></div><div class="doc"><p><code class="code">list ()</code> is the current exisiting source list.</p></div></div><h3>Creating sources</h3><div class="spec val" id="val-push"><a href="#val-push" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>push : ?&#8288;doc:string <span class="keyword">&#8209;&gt;</span> tags:(<span class="type-var">'a</span>, (<span class="type-var">'b</span>, [ `Push ]) <a href="../index.html#type-inst">inst</a>) <a href="../Tags/index.html#type-t">Tags.t</a> <span class="keyword">&#8209;&gt;</span> fields:<span class="type-var">'b</span> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, [ `Push ]) <a href="../index.html#type-src">src</a></code></div><div class="doc"><p><code class="code">push ?doc ~tags name</code> is a new push source. <code class="code">name</code> is the name
of the source; it doesn't need to be unique but it is good
practice to prefix the name with the name of your package or
library (e.g. <code class="code">&quot;mypkg.network&quot;</code>). <code class="code">doc</code> is a documentation string
describing the source, defaults to <code class="code">&quot;undocumented&quot;</code>. <code class="code">tags</code> is
the collection if (typed) tags which will be used to tag and
index the measure and are used identify the various metrics. The
source will be enabled on creation iff one of tag in <code class="code">tags</code> has
been enabled with <a href="../index.html#val-enable_tag">enable_tag</a>.</p><p>For instance, to create a metric to collect CPU usage on various
machines, indexed by hostname and core ID, use:</p><pre><code class="code">let src = let tags = Frame.[ (&quot;hostname&quot;, string); (&quot;core&quot;,
     int)] in let data () = Data.v Frame.[ (&quot;percent&quot;, Data.int @@
     Cpu.usage ()); ...  ] in Src.v ~doc:&quot;CPU usage&quot; ~tags &quot;cpu&quot; unit
     data</code></pre></div></div><h3>Timers</h3><div class="spec type" id="type-status"><a href="#type-status" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>status</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-status.Ok" class="anchored"><td class="def constructor"><a href="#type-status.Ok" class="anchor"></a><code><span class="keyword">| </span></code><code>`Ok</code></td></tr><tr id="type-status.Error" class="anchored"><td class="def constructor"><a href="#type-status.Error" class="anchor"></a><code><span class="keyword">| </span></code><code>`Error</code></td></tr></table><code> ]</code><code></code></div><div class="doc"><p>The type for event status.</p></div></div><div class="spec type" id="type-timer_src"><a href="#type-timer_src" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a timer_src</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, int64 <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-status">status</a> <span class="keyword">&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Timer ]) <a href="../index.html#type-src">src</a></code><code></code></div><div class="doc"><p>The type for timer sources. The callback takes the duration of
the event in milliseconds (an <code class="code">int64</code>) and the status: <code class="code">Error</code> or
<code class="code">Success</code>.</p></div></div><div class="spec type" id="type-timer"><a href="#type-timer" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>timer</code><code><span class="keyword"> = </span>(int64 <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-status">status</a> <span class="keyword">&#8209;&gt;</span> <a href="../Data/index.html#type-t">Data.t</a>, [ `Timer ]) <a href="../index.html#type-inst">inst</a></code><code></code></div><div class="doc"><p>The type for timer instances.</p></div></div><div class="spec val" id="val-timer"><a href="#val-timer" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>timer : ?&#8288;doc:string <span class="keyword">&#8209;&gt;</span> tags:(<span class="type-var">'a</span>, <a href="index.html#type-timer">timer</a>) <a href="../Tags/index.html#type-t">Tags.t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-timer_src">timer_src</a></code></div><div class="doc"><p>Same as <a href="index.html#val-push">push</a> but create a new timer.</p></div></div></body></html>